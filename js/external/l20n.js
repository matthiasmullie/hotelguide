'use strict';(function(){function g(a,c){function f(a){if(a)return s.source?(a=new k.Promise,a.fulfill(),a):k.IO.loadAsync(s.id).then(function(a){s.source=a});s.source||(s.source=k.IO.loadSync(s.id))}function n(){s.ast=c.parse(s.source)}function q(a,d){s.ast.body.filter(function(a,d){return"ImportStatement"==a.type?(p.push(d),!0):!1}).forEach(function(a){a=a.uri.content;if(!(null===s.id||"/"==a[0])){var d=s.id.split("/").slice(0,-1).join("/");d?("/"==d[d.length-1]&&(d=d.slice(0,d.length-1)),a=d+"/"+
a):a="./"+a}a=new g(a,c);s.resources.push(a)});var f=[];s.resources.forEach(function(c){f.push(c.build(a,d))});if(d)return k.Promise.all(f)}function B(){for(var a=s.resources.length-1;0<=a;a--)Array.prototype.splice.apply(s.ast.body,[p[a]||0,1].concat(s.resources[a].ast.body));s.isReady=!0}var s=this;this.id=a;this.resources=[];this.source=null;this.isReady=!1;this.ast={type:"LOL",body:[]};this.build=function(a,c){if(7<=a)throw new d("Too many nested imports.");if(c)return f(c).then(n).then(q.bind(this,
a+1,c)).then(B);f(c);n();q(a+1,c);B()};var p=[]}function c(a,d,c){function f(a){var d=[];s.resources.forEach(function(c){d.push(c.build(0,a))});if(a)return k.Promise.all(d)}function g(){s.ast.body=s.resources.reduce(function(a,d){return a.concat(d.ast.body)},s.ast.body)}function n(){s.entries=c.compile(s.ast);s.isReady=!0}this.id=a;this.resources=[];this.entries=null;this.ast={type:"LOL",body:[]};this.isReady=!1;this.build=function(a){return!a?(f(a),g(),n(),this):f(a).then(g).then(n)};this.getEntry=
function(a){if(this.entries.hasOwnProperty(a))return this.entries[a]};var s=this}function f(a){function f(a,b){if(!z)throw new d("Context not ready");return w(0,a,b)}function m(a,b){for(var e={},d={},c,k=0,g;g=a[k];k++){Array.isArray(g)?(c=g[0],e[c]=f(g[0],g[1])):(c=g,e[c]=f(g));for(var l in e[c].globals)e[c].globals.hasOwnProperty(l)&&(d[l]=!0)}e={entities:e};b&&(b(e),j.bindGet({id:b,callback:m.bind(this,a,b),globals:Object.keys(d)}));return{}}function w(b,a,e,j){var d;d=0==r.length-b?t:A[r[b]];
if(!d)return b=new n("Entity couldn't be retrieved",a,r),D.emit("error",b),{value:j?j:a,attributes:{},globals:{}};d.isReady||d.build(!1);var c=d.getEntry(a);if(void 0===c)return D.emit("error",new q("Not found",a,d.id)),w(b+1,a,e,j);try{return c.get(E.bind(this,e))}catch(f){if(f instanceof k.Compiler.RuntimeError)return D.emit("error",new q(f.message,a,d.id)),w(b+1,a,e,j||f.source);throw f;}}function E(a){if(!a)return this.data;var b={},e;for(e in this.data)this.data.hasOwnProperty(e)&&(b[e]=this.data[e]);
if(a)for(e in a)a.hasOwnProperty(e)&&(b[e]=a[e]);return b}function B(){y=!0;for(var a=0;a<H.length;a++){var j=H[a];if("function"===typeof j){var d=void 0;for(d in A){var f=new g(j(d),b);A[d].resources.push(f)}}else{j=new g(j,b);if(0!==r.length)for(d in d=void 0,A)A[d].resources.push(j);void 0===t&&(t=new c(null,b,e));t.resources.push(j)}}return(0<r.length?A[r[0]]:t).build(!0).then(s)}function s(){z=!0;D.emit("ready");j.retranslate()}function p(a){D.emit("error",a)}this.id=a;this.data={};this.addResource=
function(a){void 0===t&&(t=new c(null,b,e));var j=new g(null,b);j.source=a;t.resources.push(j)};this.linkResource=function(a){H.push(a)};this.registerLocales=function(){if(y&&!z)throw new d("Context not ready");r=[];for(var a in arguments){var j=arguments[a];r.push(j);A[j]=new c(j,b,e)}y&&B()};this.freeze=B;this.get=function(a,b){if(!z)throw new d("Context not ready");return w(0,a,b).value};this.getEntity=f;this.localize=function(a,b){if(!z){if(!b)throw new d("Context not ready");j.bindGet({id:b,
callback:m.bind(this,a,b),globals:[]});return{}}return m(a,b)};this.addEventListener=function(a,b){D.addEventListener(a,b)};this.removeEventListener=function(a,b){D.removeEventListener(a,b)};var r=[],A={},t,H=[],y=!1,z=!1,D=new k.EventEmitter,b=new k.Parser(k.EventEmitter),e=new k.Compiler(k.EventEmitter,k.Parser),j=new k.RetranslationManager;b.addEventListener("error",p);e.addEventListener("error",p);e.setGlobals(j.globals)}function d(a){this.name="ContextError";this.message=a}function q(a,c,f){d.call(this,
a);this.name="EntityError";this.id=c;this.lang=f;this.message="["+f+"] "+c+": "+a}function n(a,c,f){d.call(this,a);this.name="GetError";this.id=c;this.tried=f;this.message=f.length?c+": "+a+"; tried "+f.join(", "):c+": "+a}var k={Context:f,getContext:function(a){return new f(a)}};f.Error=d;f.EntityError=q;d.prototype=Object.create(Error.prototype);d.prototype.constructor=d;q.prototype=Object.create(d.prototype);q.prototype.constructor=q;n.prototype=Object.create(d.prototype);n.prototype.constructor=
n;this.L20n=k}).call(this);
(function(){var g=function(){this._state=0;this._value=null;this._cb={fulfilled:[],rejected:[]};this._thenPromises=[]};g.all=function(c){function f(){q--;0==q&&d.fulfill()}var d=new g,q=c.length;if(0==q)return d.fulfill(),d;for(var n in c)c[n].then(f,f);return d};g.prototype.then=function(c,f){this._cb.fulfilled.push(c);this._cb.rejected.push(f);var d=new g;this._thenPromises.push(d);0<this._state&&setTimeout(this._processQueue.bind(this),0);return d};g.prototype.fulfill=function(c){if(0!=this._state)return this;
this._state=1;this._value=c;this._processQueue();return this};g.prototype.reject=function(c){if(0!=this._state)return this;this._state=2;this._value=c;this._processQueue();return this};g.prototype._processQueue=function(){for(;this._thenPromises.length;){var c=this._cb.fulfilled.shift(),f=this._cb.rejected.shift();this._executeCallback(1==this._state?c:f)}};g.prototype._executeCallback=function(c){var f=this._thenPromises.shift();if("function"!=typeof c)1==this._state?f.fulfill(this._value):f.reject(this._value);
else try{var d=c(this._value);d&&"function"==typeof d.then?d.then(function(d){f.fulfill(d)},function(d){f.reject(d)}):f.fulfill(d)}catch(g){f.reject(g)}};this.L20n.Promise=g}).call(this);
(function(){this.L20n.IO={load:function(g,c){return c?this.loadAsync(g):this.loadSync(g)},loadAsync:function(g){var c=new L20n.Promise,f=new XMLHttpRequest;f.overrideMimeType("text/plain");f.addEventListener("load",function(){200==f.status?c.fulfill(f.responseText):c.reject()});f.addEventListener("abort",function(d){return c.reject(d)});f.open("GET",g,!0);f.send("");return c},loadSync:function(g){new L20n.Promise;var c=new XMLHttpRequest;c.overrideMimeType("text/plain");c.open("GET",g,!1);c.send("");
return 200==c.status?c.responseText:""}}}).call(this);
(function(){function g(f){function d(){for(var b=[],e,j;;){e=m();j=[];"["===l.charAt(h)&&(++h,a(),j=x(p,"]"));a();if(":"!==l.charAt(h))throw u('Expected ":"');++h;a();e={type:void 0,key:e,value:n(),index:j};e.local="_"===e.key.name.charAt(0);b.push(e);e=k();j=l.charAt(h);if(">"===j)break;else if(!e)throw u('Expected ">"');}return b}function g(a){for(var b=a.length,e=h+b,j=l.indexOf(a,e);-1!==j&&92===l.charCodeAt(j-1)&&92!==l.charCodeAt(j-2);)j=l.indexOf(a,j+b);if(-1===j)throw u("Unclosed string literal");
a=l.slice(e,j);h=j+b;return{type:"String",content:a}}function n(b,e){void 0===e&&(e=l.charAt(h));if("'"===e||'"'===e)return e===l.charAt(h+1)&&e===l.charAt(h+2)?g(e+e+e):g(e);if("{"===e){var j;++h;a();if("}"===l.charAt(h))++h,j={type:"Hash",content:[]};else{var d,c;for(j=[];;){d=!1;if("*"===l.charAt(h)){++h;if(d)throw u("Default item redefinition forbidden");d=!0}c=m();a();if(":"!==l.charAt(h))throw u('Expected ":"');++h;a();c={type:"HashItem",key:c,value:n()};c["default"]=d;j.push(c);a();if(d=","===
l.charAt(h))++h,a();if("}"===l.charAt(h)){++h;break}if(!d)throw u('Expected "}"');}j={type:"Hash",content:j}}return j}if(!b)throw u("Unknown value type");return null}function k(){for(var a=h,b=l.charCodeAt(a);32===b||10===b||9===b||13===b;)b=l.charCodeAt(++h);return h!==a}function a(){for(var a=l.charCodeAt(h);32===a||10===a||9===a||13===a;)a=l.charCodeAt(++h)}function v(){++h;return{type:"VariableExpression",id:m()}}function m(){var a=h,b=a,e=l,j=e.charCodeAt(b);if((97>j||122<j)&&(65>j||90<j)&&95!==
j)throw u("Identifier has to start with [a-zA-Z]");for(j=e.charCodeAt(++a);95<=j&&122>=j||65<=j&&90>=j||48<=j&&57>=j||95===j;)j=e.charCodeAt(++a);h+=a-b;return{type:"Identifier",name:e.slice(b,a)}}function w(b,j){if(!k())throw u("Expected white space");var e=l.charAt(h),c=n(!0,e),f=[];if(null===c)if(">"!==e)f=d();else throw u('Expected ">"');else if(e=k(),">"!==l.charAt(h)){if(!e)throw u('Expected ">"');f=d()}a();++h;return{type:"Entity",id:b,value:c,index:j,attrs:f,local:95===b.name.charCodeAt(0)}}
function E(){var b=l.charCodeAt(h);if(60===b){++h;var e=m(),b=l.charCodeAt(h);if(40===b){if("_"===e.name.charAt(0))throw u('Macro ID cannot start with "_"');++h;b=x(v,")");k();if("{"!==l.charAt(h))throw u('Expected "{"');++h;a();var j=t();a();if("}"!==l.charAt(h))throw u('Expected "}"');++h;a();if(62!==l.charCodeAt(h))throw u('Expected ">"');++h;return{type:"Macro",id:e,args:b,expression:j}}return 91===b?(++h,w(e,x(p,"]"))):w(e,[])}if(47===l.charCodeAt(h)&&42===l.charCodeAt(h+1)){e=h+=2;b=l.indexOf("*/",
e);if(-1===b)throw u("Comment without closing tag");h=b+2;return{type:"Comment",content:l.slice(e,b)}}if("import"===l.slice(h,h+6)){h+=6;if("("!==l.charAt(h))throw u('Expected "("');++h;a();e=g(l.charAt(h));a();if(")"!==l.charAt(h))throw u('Expected ")"');++h;return{type:"ImportStatement",uri:e}}throw u("Invalid entry");}function B(){var b=[];for(a();h<G;){try{b.push(E())}catch(e){if(e instanceof c)I.emit("error",e),b.push(M());else throw e;}h<G&&a()}return{type:"LOL",body:b}}function s(){var b=[];
for(a();h<G;)b.push(E()),h<G&&a();return{type:"LOL",body:b}}function p(){return t()}function r(b,e,j,d){for(var c=d(),f,C;;){f="";a();C=l.charAt(h);if(-1===b[0].indexOf(C))break;f+=C;++h;if(1<b.length)if(C=l.charAt(h),b[1]==C)++h,f+=C;else if(b[2]){--h;break}a();c={type:e,operator:{type:j,token:f},left:c,right:d()}}return c}function A(b,e,j,d){var c=l.charCodeAt(h);if(-1===b.indexOf(c))return d();++h;a();return{type:e,operator:{type:j,token:String.fromCharCode(c)},argument:A(b,e,j,d)}}function t(){var b=
r([["|"],"|",!0],"LogicalExpression","LogicalOperator",H);a();if(63!==l.charCodeAt(h))return b;++h;a();var e=t();a();if(58!==l.charCodeAt(h))throw u('Expected ":"');++h;a();return{type:"ConditionalExpression",test:b,consequent:e,alternate:t()}}function H(){return r([["&"],"&",!0],"LogicalExpression","Logicalperator",y)}function y(){return r([["="],"=",!0],"BinaryExpression","BinaryOperator",z)}function z(){return r([["<",">"],"=",!1],"BinaryExpression","BinaryOperator",D)}function D(){return r([["+",
"-"]],"BinaryExpression","BinaryOperator",b)}function b(){return r([["%"]],"BinaryExpression","BinaryOperator",e)}function e(){return r([["*"]],"BinaryExpression","BinaryOperator",j)}function j(){return r([["/"]],"BinaryExpression","BinaryOperator",C)}function C(){return A([43,45,33],"UnaryExpression","UnaryOperator",L)}function K(b,e){if("ParenthesisExpression"!==b.type&&"CallExpression"!==b.type&&"Identifier"!==b.type&&"ThisExpression"!==b.type)throw u("AttributeExpression must have Identifier, This, Call or Parenthesis as left node");
var j;if(e){a();j=t();a();if("]"!==l.charAt(h))throw u('Expected "]"');++h;return{type:"AttributeExpression",expression:b,attribute:j,computed:!0}}j=m();return{type:"AttributeExpression",expression:b,attribute:j,computed:!1}}function L(){var b;if(40===l.charCodeAt(h)){++h;a();var e={type:"ParenthesisExpression",expression:t()};a();if(41!==l.charCodeAt(h))throw u('Expected ")"');++h;b=e}else b=F();for(;;)if(e=l.charCodeAt(h),46===e||91===e){++h;var j=void 0;if(91===e){a();j=t();a();if("]"!==l.charAt(h))throw u('Expected "]"');
++h;b={type:"PropertyExpression",expression:b,property:j,computed:!0}}else j=m(),b={type:"PropertyExpression",expression:b,property:j,computed:!1}}else if(58===e&&58===l.charCodeAt(h+1))h+=2,91===l.charCodeAt(h)?(++h,b=K(b,!0)):b=K(b,!1);else if(40===e)++h,e=b,a(),b={type:"CallExpression",callee:e,arguments:x(p,")")};else break;return b}function F(){for(var b=h,e=l.charCodeAt(b);47<e&&58>e;)e=l.charCodeAt(++b);if(b>h)return e=h,h=b,{type:"Number",value:parseInt(l.slice(e,b),10)};switch(e){case 39:case 34:case 123:case 91:return n();
case 36:return v();case 64:return++h,{type:"GlobalsExpression",id:m()};case 126:return++h,{type:"ThisExpression"};default:return m()}}function x(b,e){var j;a();if(l.charAt(h)===e)return++h,[];for(var d=[];;)if(d.push(b()),a(),j=l.charAt(h),","===j)++h,a();else if(j===e){++h;break}else throw u('Expected "," or "'+e+'"');return d}function u(b,e){void 0===e&&(e=h);var a=l.lastIndexOf("<",e-1),j=l.lastIndexOf(">",e-1),a=l.slice(j>a?j+1:a,e+10);return new c(b+" at pos "+e+': "'+a+'"',e,a)}function M(){var b=
l.indexOf("<",h),e;if(-1===b)return e={type:"JunkEntry",content:l.slice(h)},h=G,e;e={type:"JunkEntry",content:l.slice(h,b)};h=b;return e}this.parse=function(b){l=b;h=0;G=l.length;return J()};this.parseString=function(b){l=b;h=0;G=l.length;try{var e;var j,d;b=h;for(var C=!1,g=l.indexOf("\\");-1!==g;){j=l.charAt(g+1);if('"'==j||"'"==j||"\\"==j)l=l.substr(0,g)+l.substr(g+1);g=l.indexOf("\\",g+1)}for(g=l.indexOf("{{");-1!==g;)if(92===l.charCodeAt(g-1))l=l.substr(0,g-1)+l.substr(g),g=l.indexOf("{{",g+
2);else{C||(d=[],C=!0);b<g&&d.push({type:"String",content:l.slice(b,g)});h=g+2;a();d.push(t());a();if(125!==l.charCodeAt(h)||125!==l.charCodeAt(h+1))throw u('Expected "}}"');b=g=h+2;g=l.indexOf("{{",g)}C?(b<G&&d.push({type:"String",content:l.slice(b)}),e={type:"ComplexString",content:d}):e={type:"String",content:l};return e}catch(k){throw f&&k instanceof c&&I.emit("error",k),k;}};this.addEventListener=function(b,e){if(!I)throw Error("Emitter not available");return I.addEventListener(b,e)};this.removeEventListener=
function(b,e){if(!I)throw Error("Emitter not available");return I.removeEventListener(b,e)};var l,h,G,I,J;f?(I=new f,J=B):J=s}function c(c,d,g){this.name="ParserError";this.message=c;this.pos=d;this.context=g}g.Error=c;c.prototype=Object.create(Error.prototype);c.prototype.constructor=c;"undefined"!==typeof exports?exports.Parser=g:this.L20n?this.L20n.Parser=g:this.L20nParser=g}).call(this);
(function(){function g(){function d(f){f=new f;this.globals[f.id]=f;a[f.id]=0;f.addEventListener("change",function(a){for(var d=0;d<c.length;d++)c[d]&&-1!==c[d].globals.indexOf(a)&&c[d].callback()})}var c=[],a={},f=[];this.bindGet=function(d){for(var g,n=0;n<f.length;n++)if(f[n].id===d.id){g=!0;break}g||f.push(d);var m=null;for(g=0;g<c.length;g++)if(c[g]&&c[g].id===d.id){m=c[g];break}m?0==d.globals.length?delete c[g]:(d.globals.filter(function(a){return-1===m.globals.indexOf(a)}).forEach(function(d){a[d]++;
this.globals[d].activate()},this),m.globals.filter(function(a){return-1===d.globals.indexOf(a)}).forEach(function(d){a[d]--;0==a[d]&&this.globals[d].deactivate()}),m.globals=d.globals):0!=d.globals.length&&(c.push(d),d.globals.forEach(function(d){a[d]++;this.globals[d].activate()},this))};this.retranslate=function(){for(var a=0;a<f.length;a++)f[a].callback()};this.globals={};for(var m in g._constructors)d.call(this,g._constructors[m])}function c(){this.id=null;this._emitter=new L20n.EventEmitter}
function f(){function d(){f=document.body.clientWidth;a._emitter.emit("change",a.id)}c.call(this);this.id="screen";this.get=function(){f||(f=document.body.clientWidth);return{width:f}};this.activate=function(){this.isActive||(window.addEventListener("resize",d),this.isActive=!0)};this.isActive=!1;var f=null,a=this}function d(){c.call(this);this.id="os";this.get=function(){return/^MacIntel/.test(navigator.platform)?"mac":/^Linux/.test(navigator.platform)?"linux":/^Win/.test(navigatgor.platform)?"win":
"unknown"}}function q(){function d(){var c=new Date;c.getHours()!==a&&(a=c.getHours(),f._emitter.emit("change",f.id))}c.call(this);this.id="hour";this.get=function(){a||(a=(new Date).getHours());return a};this.activate=function(){this.isActive||(m=setTimeout(function(){d();m=setInterval(d,g)},g-(new Date).getTime()%g),this.isActive=!0)};this.deactivate=function(){a=null;clearInterval(m);this.isActive=!1};this.isActive=!1;var f=this,a=null,g=36E5,m=null}g._constructors=[];g.registerGlobal=function(d){g._constructors.push(d)};
c.prototype.addEventListener=function(d,c){if("change"!==d)throw"Unknown event type";this._emitter.addEventListener(d,c)};c.prototype.activate=function(){};c.prototype.deactivate=function(){};g.Global=c;f.prototype=Object.create(c.prototype);f.prototype.constructor=f;d.prototype=Object.create(c.prototype);d.prototype.constructor=d;q.prototype=Object.create(c.prototype);q.prototype.constructor=q;g.registerGlobal(f);g.registerGlobal(d);g.registerGlobal(q);this.L20n.RetranslationManager=g}).call(this);
(function(){function g(){this._listeners={}}g.prototype.emit=function(){var c=Array.prototype.slice.call(arguments),f=c.shift(),f=this._listeners[f];if(!f||!f.length)return!1;f.forEach(function(d){d.apply(this,c)},this);return!0};g.prototype.addEventListener=function(c,f){this._listeners[c]||(this._listeners[c]=[]);this._listeners[c].push(f);return this};g.prototype.removeEventListener=function(c,f){var d=this._listeners[c].indexOf(f);if(-1===d)return this;listeners.splice(d,1);return this};"undefined"!==
typeof exports?exports.EventEmitter=g:this.L20n?this.L20n.EventEmitter=g:this.L20nEventEmitter=g}).call(this);
(function(){function g(a,c){var g;function w(b,e,a,d){b=new b(e,a,d);t&&t.emit("error",b);return b}function E(b){this.id=b.id.name;this.local=b.local||!1;this.index=[];this.attributes={};this.publicAttributes=[];var e;for(e=0;e<b.index.length;e++)this.index.push(p(b.index[e],this));for(e=0;e<b.attrs.length;e++){var a=b.attrs[e];this.attributes[a.key.name]=new B(a,this);a.local||this.publicAttributes.push(a.key.name)}this.value=p(b.value,this,this.index)}function B(b,e){this.key=b.key.name;this.local=
b.local||!1;this.index=[];for(var a=0;a<b.index.length;a++)this.index.push(p(b.index[a],this));this.value=p(b.value,e,this.index);this.entity=e}function s(b){this.id=b.id.name;this.local=b.local||!1;this.expression=p(b.expression,this);this.args=b.args}function p(b,e,a){if(!b)return null;if(!D[b.type])throw w("CompilationError","Unknown expression type"+b.type);a&&(a=a.slice());return D[b.type](b,e,a)}function r(b,e,a){if(!b||"string"===typeof b||"boolean"===typeof b||"number"===typeof b)return b;
if(b._resolve)return b._resolve(a);b=b(e,a);e=b[0];b=b[1];return r(b,e,a)}function A(b,e){if("=="==b)return function(b,a){if(("number"!==typeof b||"number"!==typeof a)&&("string"!==typeof b||"string"!==typeof a))throw new d("The == operator takes two numbers or two strings",e);return b==a};if("!="==b)return function(b,a){if(("number"!==typeof b||"number"!==typeof a)&&("string"!==typeof b||"string"!==typeof a))throw new d("The != operator takes two numbers or two strings",e);return b!=a};if("<"==b)return function(b,
a){if("number"!==typeof b||"number"!==typeof a)throw new d("The < operator takes two numbers",e);return b<a};if("<="==b)return function(b,a){if("number"!==typeof b||"number"!==typeof a)throw new d("The <= operator takes two numbers",e);return b<=a};if(">"==b)return function(b,a){if("number"!==typeof b||"number"!==typeof a)throw new d("The > operator takes two numbers",e);return b>a};if(">="==b)return function(b,a){if("number"!==typeof b||"number"!==typeof a)throw new d("The >= operator takes two numbers",
e);return b>=a};if("+"==b)return function(b,a){if(("number"!==typeof b||"number"!==typeof a)&&("string"!==typeof b||"string"!==typeof a))throw new d("The + operator takes two numbers or two strings",e);return b+a};if("-"==b)return function(b,a){if("number"!==typeof b||"number"!==typeof a)throw new d("The - operator takes numbers",e);return b-a};if("*"==b)return function(b,a){if("number"!==typeof b||"number"!==typeof a)throw new d("The * operator takes numbers",e);return b*a};if("/"==b)return function(b,
a){if("number"!==typeof b||"number"!==typeof a)throw new d("The / operator takes two numbers",e);if(0==a)throw new d("Division by zero not allowed.",e);return b/a};if("%"==b)return function(b,a){if("number"!==typeof b||"number"!==typeof a)throw new d("The % operator takes two numbers",e);return b%a};throw w(f,"Unknown token: "+b,e);}this.compile=function(b){y={};for(var a={Entity:E,Macro:s},d=0,c;c=b.body[d];d++){var f=a[c.type];if(f)try{y[c.id.name]=new f(c)}catch(g){k(g)}}return y};this.setGlobals=
function(b){z=b;return!0};this.addEventListener=function(b,a){if(!t)throw Error("Emitter not available");return t.addEventListener(b,a)};this.removeEventListener=function(b,a){if(!t)throw Error("Emitter not available");return t.removeEventListener(b,a)};this.reset=function(){y={};z={};g={};return this};var t=a?new a:null,H=c?new c:null,y={},z={};g={};E.prototype._yield=function(b,a){return this.value({__this__:this},b,a)};E.prototype._resolve=function(b){return r(this.value,{__this__:this},b)};E.prototype.getString=
function(b){try{return this._resolve(b)}catch(a){throw k(a),a instanceof q&&t&&t.emit("error",a),a;}};E.prototype.get=function(b){g={};for(var a={value:this.getString(b),attributes:{}},d=0,c;c=this.publicAttributes[d];d++)a.attributes[c]=this.attributes[c].getString(b);a.globals=g;return a};B.prototype._yield=function(b,a){return this.value({__this__:this.entity},b,a)};B.prototype._resolve=function(b){return r(this.value,{__this__:this.entity},b)};B.prototype.getString=function(b){try{return this._resolve(b)}catch(a){throw k(a),
a instanceof q&&t&&t.emit("error",a),a;}};s.prototype._call=function(b,a){for(var d={__this__:this},c=0;c<this.args.length;c++)d[this.args[c].id.name]=a[c];return this.expression(d,b)};var D={Identifier:function(b,a){var c=b.name;return function(b){if(!y.hasOwnProperty(c))throw new d("Reference to an unknown entry: "+c,a);b.__this__=y[c];return[b,y[c]]}},ThisExpression:function(){return function(b){return[b,b.__this__]}},VariableExpression:function(b,a){var c=b.id.name;return function(b,f){if(b.hasOwnProperty(c))return b[c];
if(!f||!f.hasOwnProperty(c))throw new d("Reference to an unknown variable: "+c,a);return[b,f[c]]}},GlobalsExpression:function(b,a){var c=b.id.name;return function(b){if(!z)throw new d("Globals missing (tried @"+c+").",a);if(!z.hasOwnProperty(c))throw new d("Reference to an unknown global: "+c,a);g[c]=!0;return[b,z[c].get()]}},Number:function(b){return function(a){return[a,b.value]}},String:function(b,a){var d,c;return function(f,g){if(!c){try{d=H.parseString(b.content)}catch(m){throw new q("Malformed string. "+
m.message,a,b.content);}if("String"==d.type)return[f,d.content];c=p(d,a)}try{return[f,r(c,f,g)]}catch(n){throw k(n),new q(n.message,a,b.content);}}},Hash:function(a,d,c){for(var f=[],g,m=c.length?c.shift():void 0,F=0;F<a.content.length;F++){var x=a.content[F];f[x.key.name]=p(x.value,d,c);x.default&&(g=x.key.name)}return function(a,b,c){c=[c,m,g];for(var h=[],j=0;j<c.length;j++){try{var x=c[j]=r(c[j],a,b)}catch(F){throw k(F),w(n,F.message,d);}if(void 0!==x){if("string"!==typeof x)throw w(n,"Index must be a string",
d);h.push(x);if(f.hasOwnProperty(x))return[a,f[x]]}}throw w(n,h.length?'Hash key lookup failed (tried "'+h.join('", "')+'").':"Hash key lookup failed.",d);}},HashItem:p,ComplexString:function(a,e){for(var c=[],f=0;f<a.content.length;f++)c.push(p(a.content[f],e));var g=!1;return function(a,b){if(g)throw new d("Cyclic reference detected",e);g=!0;var f=[];try{for(var m=0;m<c.length;m++){var k=r(c[m],a,b);if("string"!==typeof k&&"number"!==typeof k)throw new d("Placeables must be strings or numbers",
e);f.push(k)}}finally{g=!1}return[a,f.join("")]}},UnaryExpression:function(a,e){var c;var g=a.operator.token;if("-"==g)c=function(a){if("number"!==typeof a)throw new d("The unary - operator takes a number",e);return-a};else if("+"==g)c=function(a){if("number"!==typeof a)throw new d("The unary + operator takes a number",e);return+a};else if("!"==g)c=function(a){if("boolean"!==typeof a)throw new d("The ! operator takes a boolean",e);return!a};else throw w(f,"Unknown token: "+g,e);var m=p(a.argument,
e);return function(a,b){return[a,c(r(m,a,b))]}},BinaryExpression:function(a,d){var c=p(a.left,d),f=A(a.operator.token,d),g=p(a.right,d);return function(a,b){return[a,f(r(c,a,b),r(g,a,b))]}},LogicalExpression:function(a,c){var g=p(a.left,c),m;var k=a.operator.token;if("&&"==k)m=function(a,b){if("boolean"!==typeof a||"boolean"!==typeof b)throw new d("The && operator takes two booleans",c);return a&&b};else if("||"==k)m=function(a,b){if("boolean"!==typeof a||"boolean"!==typeof b)throw new d("The || operator takes two booleans",
c);return a||b};else throw w(f,"Unknown token: "+k,c);var n=p(a.right,c);return function(a,b){return[a,m(r(g,a,b),r(n,a,b))]}},ConditionalExpression:function(a,c){var f=p(a.test,c),g=p(a.consequent,c),m=p(a.alternate,c);return function(a,b){var k=r(f,a,b);if("boolean"!==typeof k)throw new d("Conditional expressions must test a boolean",c);return!0===k?g(a,b):m(a,b)}},CallExpression:function(a,c){for(var f=p(a.callee,c),g=[],m=0;m<a.arguments.length;m++)g.push(p(a.arguments[m],c));return function(a,
b){for(var m=[],k=0;k<g.length;k++)m.push(g[k](a,b));k=f(a,b);k=k[1];if(!k._call)throw new d("Expected a macro, got a non-callable.",c);return k._call(b,m)}},PropertyExpression:function(a,c){var f=p(a.expression,c),g=a.computed?p(a.property,c):a.property.name;return function(a,b){var m=r(g,a,b),k=f(a,b);a=k[0];k=k[1];if(k._yield)return k._yield(b,m);if("function"!==typeof k){if(!k.hasOwnProperty(m))throw new d(m+" is not defined in the context data",c);return[null,k[m]]}return k(a,b,m)}},AttributeExpression:function(a,
c){var d=p(a.expression,c),f=a.computed?p(a.attribute,c):a.attribute.name;return function(a,b){var c=r(f,a,b),e=d(a,b);a=e[0];e=e[1];return[a,e.attributes[c]]}},ParenthesisExpression:function(a,c){return p(a.expression,c)}}}function c(a,c){this.name="CompilerError";this.message=a;this.entry=c.id}function f(a,d){c.call(this,a,d);this.name="CompilationError"}function d(a,d){c.call(this,a,d);this.name="RuntimeError"}function q(a,c,f){d.call(this,a,c);this.name="ValueError";this.source=f}function n(a,
c){d.call(this,a,c);this.name="IndexError"}function k(a){if(!(a instanceof c))throw a;}g.Error=c;g.CompilationError=f;g.RuntimeError=d;g.ValueError=q;g.IndexError=n;c.prototype=Object.create(Error.prototype);c.prototype.constructor=c;f.prototype=Object.create(c.prototype);f.prototype.constructor=f;d.prototype=Object.create(c.prototype);d.prototype.constructor=d;q.prototype=Object.create(d.prototype);q.prototype.constructor=q;n.prototype=Object.create(d.prototype);n.prototype.constructor=n;"undefined"!==
typeof exports?exports.Compiler=g:this.L20n?this.L20n.Compiler=g:this.L20nCompiler=g}).call(this);
(function(){this.L20n.Intl={prioritizeLocales:function(g){for(var c={localeMatcher:"lookup"},f=[navigator.language||navigator.userLanguage],d=0,q=f.length,n=void 0;d<q&&void 0===n;){var k=f[d],a=k;a:{for(var n=g,v=a;;){if(-1!==n.indexOf(v)){n=v;break a}var m=v.lastIndexOf("-");if(-1===m){n=void 0;break a}2<=m&&"-"==v[m-2]&&(m-=2);v=v.substr(0,m)}n=void 0}d+=1}f={};if(void 0!==n){if(f.locale=n,k!==a)throw"NotImplemented";}else f.locale="en-US";k=f.locale;if(f.hasOwnProperty("extension"))throw"NotImplemented";
a="-u";for(f=0;0>f;){d=(void 0)(k)[k];q=d[0];n="";if(void 0!==extensionSubtags)throw"NotImplemented";c.hasOwnProperty("key")&&(v=c.key,-1!==d.indexOf(v)&&v!==q&&(n=""),a+=n,f+=1)}2<a.length&&(c=k.substr(0,extensionIndex),k=k.substr(extensionIndex+1),k=c+a+k);c=k;k=g.indexOf(c);if(-1===k)return g;g.splice(k,1);g.unshift(c);return g}}}).call(this);
(function(){function g(){document.body?(q(document),c()):document.addEventListener("readystatechange",f);HTMLDocument.prototype.__defineGetter__("l10n",function(){return n});n.addEventListener("ready",function(){var a=document.createEvent("Event");a.initEvent("LocalizationReady",!1,!1);document.dispatchEvent(a)});n.addEventListener("error",function(a){a.code&L20n.NOVALIDLOCALE_ERROR&&(a=document.createEvent("Event"),a.initEvent("LocalizationFailed",!1,!1),document.dispatchEvent(a))});n.freeze()}function c(){document.body.style.visibility=
"visible";var a=document.createEvent("Event");a.initEvent("DocumentLocalized",!1,!1);document.dispatchEvent(a)}function f(){"interactive"===document.readyState&&(q(document),c(),document.removeEventListener("readystatechange",f))}function d(a,c){for(var d=a.querySelectorAll("[data-l10n-id]"),f,g=0;g<d.length;g++){f=d[g].getAttribute("data-l10n-id");f=c.entities[f];a=d[g];f.value&&(a.textContent=f.value);for(var k in f.attributes)a.setAttribute(k,f.attributes[k])}}function q(a){for(var c=a.querySelectorAll("[data-l10n-id]"),
f=[],g=0;g<c.length;g++)c[g].hasAttribute("data-l10n-args")?f.push([c[g].getAttribute("data-l10n-id"),JSON.parse(c[g].getAttribute("data-l10n-args"))]):f.push(c[g].getAttribute("data-l10n-id"));n.localize(f,d.bind(this,a))}var n=this.L20n.getContext(document.location.host),k;document.body&&(document.body.style.visibility="hidden");k=document.head;var a=k.querySelector('script[type="application/l10n-data+json"]');a&&(n.data=JSON.parse(a.textContent));if(a=k.querySelector('script[type="application/l20n"]'))a.hasAttribute("src")?
n.linkResource(a.getAttribute("src")):n.addResource(a.textContent),g();else if(k=k.querySelector('link[rel="localization"]')){k=k.getAttribute("href");var v=new L20n.Promise;L20n.IO.load(k,!0).then(function(a){var c=JSON.parse(a);a=L20n.Intl.prioritizeLocales(c.languages);n.registerLocales.apply(this,a);n.linkResource(function(a){return c.resources[0].replace("{{lang}}",a)});v.fulfill()});v.then(g)}}).call(this);
